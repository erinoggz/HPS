version: 3
sources:
  - name: revkeep
    kind: postgres
    configuration:
      connection_info: { database_url: "postgres://postgres:postgrespassword@postgres:5432/hasura" }
    tables:
      - table: { schema: revkeep, name: testtable }
        select_permissions: [{ role: view, permission: { columns: '*', filter: { id: { _eq: 'X-Hasura-User-Id' } }, allow_aggregations: true, limit: 100 } }]
        insert_permissions: [{ role: view, permission: { columns: '*', check: {} } }]
        update_permissions: [{ role: view, permission: { columns: '*', filter: {} } }]
        delete_permissions: [{ role: view, permission: { filter: {} } }]
roles:
  - name: view
    description: "Role with full CRUD access to testtable"
    table_permissions: 
      - table: testtable
        permissions: { select: true, insert: true, update: true, delete: true }